{% extends 'layout.html' %}
{% block title %}Manage Exams{% endblock %}

{% block content %}
<h2 class="mb-4">Manage Exams</h2>
<a href="{{ url_for('teacher.create_exam') }}" class="btn btn-primary mb-3">➕ Create New Exam</a>

{% if exams %}
<table class="table table-striped table-bordered">
    <thead class="table-dark">
        <tr>
            <th>Title</th>
            <th>Instructions</th>
            <th>Created At</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for exam in exams %}
        <tr>
            <td>{{ exam.title }}</td>
            <td>{{ exam.instructions[:50] }}{% if exam.instructions|length > 50 %}...{% endif %}</td>
            <td>{{ exam.created_at[:19] }}</td>
            <td>
                {% if exam.active %}
                <span class="badge bg-success">Published</span>
                {% else %}
                <span class="badge bg-secondary">Unpublished</span>
                {% endif %}
            </td>
            <td class="d-flex gap-1">
                <a href="{{ url_for('teacher.view_submissions', exam_id=exam.id) }}" class="btn btn-sm btn-info">📄
                    Submissions</a>
                <a href="{{ url_for('teacher.add_question', exam_id=exam.id) }}" class="btn btn-sm btn-success">➕
                    Questions</a>
                <form action="{{ url_for('teacher.toggle_exam_status', exam_id=exam.id) }}" method="POST">
                    <button type="submit" class="btn btn-sm btn-outline-{{ 'danger' if exam.active else 'success' }}">
                        {{ 'Unpublish' if exam.active else 'Publish' }}
                    </button>
                </form>
                <a href="{{ url_for('teacher.preview_exam', exam_id=exam.id) }}" class="btn btn-sm btn-warning">👁️
                    Preview</a>
                <a href="{{ url_for('teacher.edit_exam', exam_id=exam.id) }}" class="btn btn-sm btn-secondary">✏️
                    Edit</a>
                <form action="{{ url_for('teacher.delete_exam', exam_id=exam.id) }}" method="POST" class="d-inline">
                    <button type="submit" class="btn btn-sm btn-danger"
                        onclick="return confirm('Are you sure you want to delete this exam?')">
                        🗑️ Delete
                    </button>
                </form>

            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="alert alert-info">No exams created yet.</div>
{% endif %}
{% endblock %}